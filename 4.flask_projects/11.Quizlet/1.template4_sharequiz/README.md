# Flask 기반 사용자 맞춤형 퀴즈 앱

이 프로젝트는 사용자가 퀴즈 파일을 업로드하고, 공부/시험 모드를 선택하여 퀴즈를 진행할 수 있는 **사용자 맞춤형 웹 서비스**입니다.  
각 사용자는 **자신만의 설정, 업로드 파일, 시험 결과**를 관리할 수 있습니다.

---

## 주요 기능

- **사용자 관리**: 회원가입 / 로그인 / 로그아웃 (Flask-Login 활용)
- **개인 파일 관리**: 사용자별 문제 파일 업로드 및 관리 (Excel 지원)
- **맞춤 설정**: 사용자별 문제/보기 순서, 문항 수 제한 등
- **학습 모드**: 정답과 해설을 바로 확인하며 공부
- **시험 모드**: 실제 시험처럼 문제를 풀고 채점 (타이머, 진행률 포함)
- **통계 대시보드**: 최근 10/30/전체 시험 결과를 Chart.js로 시각화
- **프로필 관리**: 성취 배지, 학습 진행상황, 계정 정보 수정
- **시험 기록**: 상세한 시험 히스토리 및 결과 관리
 - **문제 공유/검색/가져오기 (신규)**:
   - 내 퀴즈 파일을 공개/비공개로 전환 (대시보드에서 토글)
   - 상단 메뉴의 "검색" 탭에서 다른 사용자의 공개 퀴즈 검색
   - 공개 퀴즈를 내 계정으로 "가져오기" 후 수정/재공유 가능

---

## 실행 방법

### 1. 프로젝트 클론 및 가상환경 설정
```bash
git clone <repository_url>
cd quizlet_app

# 가상환경 생성 및 활성화
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

### 2. 의존성 설치
```bash
pip install -r requirements.txt
```

### 3. 데이터베이스 초기화 (최초 1회)
```bash
python database.py
```

### 3-1. 마이그레이션 (구버전 → 신버전 자동 처리)
- 기존 DB 파일이 있는 경우, 앱 실행 시 자동으로 스키마 마이그레이션을 수행합니다.
- 수동 실행이 필요하면 아래 명령으로도 수행할 수 있습니다:
```bash
python -c "from migration import run_migrations; run_migrations(); print('done')"
```

### 4. 서버 실행
```bash
python app.py
```

### 5. 브라우저에서 접속
```
http://localhost:5000
```

---

## 디렉토리 구조

```
quizlet_app/
├── app.py                          # Flask 앱 진입점 (Blueprint 등록 포함)
├── database.py                     # SQLite DB 초기화 및 테이블 생성
├── migration.py                    # 스키마 마이그레이션 (자동/수동 실행 가능)
├── requirements.txt                # 필요한 패키지 목록
├── README.md                       # 프로젝트 설명서
│
├── routes/                         # 기능별 Flask Blueprint
│   ├── __init__.py                 # Blueprint 패키지 초기화
│   ├── user_routes.py              # 회원가입/로그인/로그아웃/프로필 라우트
│   ├── quiz_routes.py              # 파일 업로드, 삭제, 문제 풀이 라우트
│   └── result_routes.py            # 시험 결과 저장 및 통계 시각화 라우트
│
├── templates/                      # Jinja2 HTML 템플릿 파일
│   ├── base.html                   # 기본 레이아웃 (네비게이션 포함)
│   ├── index.html                  # 메인 대시보드 (파일 업로드, 퀴즈 시작)
│   ├── login.html                  # 로그인 폼
│   ├── register.html               # 회원가입 폼
│   ├── profile.html                # 프로필 페이지 (성취 배지, 계정 설정)
│   ├── study.html                  # 공부 모드 화면 (정답/해설 표시)
│   ├── quiz.html                   # 시험 모드 화면 (타이머, 진행률 포함)
│   ├── result.html                 # 시험 결과 상세 페이지
│   ├── result_detail.html          # 개별 시험 결과 상세보기
│   ├── settings.html               # 사용자별 퀴즈 설정
│   ├── stats.html                  # 통계 대시보드 (Chart.js 그래프)
│   ├── history.html                # 시험 기록 히스토리
│   ├── 404.html                    # 404 에러 페이지
│   └── 500.html                    # 500 에러 페이지
│
├── static/                         # 정적 파일
│   └── css/
│       └── style.css               # 공통 스타일시트
│
├── data/
│   └── uploads/
│       ├── user_1/                 # 사용자별 업로드 폴더
│       ├── user_2/                 # (사용자 ID 기반으로 자동 생성)
│       └── ...
│
└── quizlet.db                      # SQLite 데이터베이스 파일 (자동 생성)
```

---

## 데이터베이스 스키마

### users 테이블
```sql
- 사용자 계정 정보 (id, username, email, password_hash, created_at)
- Flask-Login 호환 사용자 클래스와 연동
```

### quiz_files 테이블
```sql
- 사용자별 업로드된 퀴즈 파일 정보
- 파일 경로, 문제 수, 업로드 날짜 등
- 사용자별 데이터 격리 (user_id foreign key)
- 공유 기능 관련 컬럼 (신규):
  - is_public INTEGER DEFAULT 0
  - shared_by_user_id INTEGER (원본 소유자 ID, 가져오기 시 기록)
```

### quiz_results 테이블
```sql
- 시험 결과 저장 (점수, 정답 수, 소요 시간)
- 시험 설정 정보 (JSON 형태로 저장)
- 통계 그래프 데이터 소스
```

### user_settings 테이블
```sql
- 사용자별 퀴즈 설정 (문제 순서, 보기 순서, 문항 수 제한)
- 공부 모드 / 시험 모드 각각 독립 설정
```

---

## 사용 기술 스택

### Backend
- **Flask 2.3.3**: 웹 프레임워크
- **Flask-Login 0.6.3**: 사용자 인증 및 세션 관리
- **SQLite3**: 경량 데이터베이스 (순수 SQL 쿼리 사용)
- **openpyxl 3.1.2**: Excel 파일 처리
- **Werkzeug 2.3.7**: 보안 (비밀번호 해싱)

### Frontend
- **Bootstrap 5.1.3**: 반응형 UI 프레임워크
- **Chart.js**: 시험 점수 그래프 시각화
- **JavaScript (ES6+)**: AJAX 통신, 동적 UI 업데이트
- **Jinja2**: 템플릿 엔진

---

## 주요 기능 설명

### 1. 사용자 인증 및 관리
- Flask-Login을 활용한 안전한 세션 관리
- 비밀번호 해싱으로 보안 강화
- `@login_required` 데코레이터로 페이지 접근 제어
- **모달 팝업**을 통한 이메일/비밀번호 변경 (AJAX)

### 2. 파일 관리
- 사용자별 격리된 업로드 폴더 (`data/uploads/user_{id}/`)
- Excel 파일 업로드 및 파싱 (openpyxl 사용)
- 본인 파일만 조회/삭제 가능
- 템플릿 다운로드 기능

### 3. 퀴즈 기능
- **공부 모드**: 정답과 해설을 즉시 확인
- **시험 모드**: 실제 시험 환경 (타이머, 진행률, 제출 확인)
- 문제/보기 순서 셔플링 지원
- 문항 수 제한 기능
- 사용자별 설정 저장

### 4. 통계 및 기록 관리
- **Chart.js**를 활용한 시각적 점수 추이
- 최근 10회/30회/전체 결과 필터링
- 시험 히스토리 페이지네이션
- 개별 시험 결과 상세보기
- 결과 삭제 기능

### 5. 프로필 및 성취 시스템
- **성취 배지**: 시험 횟수, 점수 기반 배지 시스템
- **학습 진행상황**: 목표 달성률 시각화
- **계정 정보 관리**: 이메일/비밀번호 변경

---

## 보안 고려사항

- **사용자별 데이터 격리**: 다른 사용자의 파일/결과 접근 불가
- **세션 기반 인증**: Flask-Login의 보안 세션 관리
- **파일 업로드 제한**: Excel 파일만 허용, 파일 크기 제한 (16MB)
- **SQL 인젝션 방지**: 파라미터화된 쿼리 사용
- **XSS 방지**: Jinja2 자동 이스케이핑
- **CSRF 보호**: Flask 내장 보안 기능 활용

---

## 특별한 기능들

### 🎯 **실시간 시험 환경**
- 타이머 기능
- 실시간 진행률 표시
- 페이지 이탈 경고 (선택사항)
- 답변 상태 실시간 업데이트

### 📊 **고급 통계**
- Chart.js를 활용한 인터랙티브 그래프
- 필터링 가능한 통계 데이터
- 점수 추이 분석

### 🏆 **게이미피케이션**
- 성취 배지 시스템
- 학습 목표 및 진행률
- 회원 등급 시스템

### 💻 **현대적인 UI/UX**
- 반응형 디자인 (모바일 지원)
- 모달 팝업을 통한 seamless UX
- 토스트 알림 시스템
- 다크모드 지원 (CSS)

---
